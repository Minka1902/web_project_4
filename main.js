!function(){"use strict";class e{constructor(e,t,s,n,i,r,o){var a,l;l=()=>{this._element.querySelector(".card__like-button").addEventListener("click",(()=>{this._element.querySelector(".card__like-button").classList.contains("info__card_like-button_state_active")||(this._justLiked=!0),this._checkLikes()})),this._element.querySelector(".card__delete").addEventListener("click",(()=>{this._confirmPopup.open(),this._confirmPopup.querySelector(".popup__button").addEventListener("click",(()=>{"b8bd21835a45fea0c36dd776"===this._owner._id&&(this._deleteCard(),fetch("https://around.nomoreparties.co/v1/group-12/cards/".concat(this._id),{method:"DELETE",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61"}})),this._confirmPopup.close()}))})),this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({url:this._link,caption:this._name})}))},(a="_setEventListeners")in this?Object.defineProperty(this,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):this[a]=l,this._name=e,this._link=t,this._id=s,this._likes=n,this._handleImageClick=i,this._confirmPopup=r,this._owner=o}generateCard(){return this._createCard(),this._setEventListeners(),this._toggleLikes(),this._element}_createCard(){this._element=this._getTemplate();const e=this._element,t=e.querySelector(".card__image");return e.querySelector(".card__text").textContent=this._name,t.src=this._link,t.alt="A view of ".concat(this._name),e.querySelector(".card__like-number").textContent=this._getLikeNumber(),e}_resetCardLikes(){this._element.querySelector(".card__like-number").textContent=this._getLikeNumber()}_getTemplate(){const e=document.querySelector("#cardtemplate").content.querySelector(".card").cloneNode(!0);return this._owner&&"b8bd21835a45fea0c36dd776"!==this._owner._id&&e.querySelector(".card__delete").classList.add("card__delete_hidden"),e}_getLikeNumber(){return this._likes?this._likes.length:0}_isLiked(){for(let e=0;e<this._likes.length;e++)return"b8bd21835a45fea0c36dd776"===this._likes[e]._id}_checkLikes(){this._justLiked?(this._element.querySelector(".card__like-button").classList.add("info__card_like-button_state_active"),this._likes&&(this._likes[this._likes.length]=this._owner),fetch("https://around.nomoreparties.co/v1/group-12/cards/likes/".concat(this._id),{method:"PUT",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61"}}),this._justLiked=!1):(this._element.querySelector(".card__like-button").classList.remove("info__card_like-button_state_active"),this._likes.pop(),fetch("https://around.nomoreparties.co/v1/group-12/cards/likes/".concat(this._id),{method:"DELETE",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61"}})),this._resetCardLikes()}_toggleLikes(){if(this._likes)for(let e=0;e<this._likes.length;e++)"b8bd21835a45fea0c36dd776"===this._likes[e]._id&&this._element.querySelector(".card__like-button").classList.add("info__card_like-button_state_active")}_deleteCard(){this._element.remove()}}class t{constructor(e,t){this._form=t,this._setSettings(e)}_setSettings(e){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}enableValidation(){this._formSelector&&(this._form.addEventListener("submit",(e=>e.preventDefault())),[...this._form.querySelectorAll(this._inputSelector)].forEach((e=>{e.addEventListener("input",(e=>{this._handleInputEvent(e.target),this.validateButton()}))})))}_handleInputEvent(e){const t=e.parentElement.querySelector(".".concat(e.id,"-error"));this._checkInputValidity(e)?(this._hideErrorMessage(t,this._errorClass),e.classList.remove(this._inputErrorClass)):(this._showErrorMessage(t,this._errorClass),e.classList.add(this._inputErrorClass))}_checkFormValidity(e){const t=[...e.querySelectorAll(this._inputSelector)];let s=!0;for(let e=0;e<t.length;e++)this._checkInputValidity(t[e])||(s=!1);return s}_hideErrorMessage(e){e.classList.remove(this._errorClass)}_showErrorMessage(e){e.classList.add(this._errorClass)}validateButton(){const e=this._form.querySelector(this._submitButtonSelector);this._checkFormValidity(this._form,this._inputSelector)?this.toggleButtonState(e,!0):this.toggleButtonState(e,!1)}_checkInputValidity(e){return e.validity.valid}toggleButtonState(e,t){t?(e.classList.remove(this._inactiveButtonClass),e.disabled=!1):(e.classList.add(this._inactiveButtonClass),e.disabled=!0)}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){s(this,"close",(()=>{this._isOpen=!1,this._element.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)})),s(this,"_handleEscClose",(e=>{"Escape"==e.code&&this.close()})),this._isOpen=!1,this._element=document.querySelector(e)}getElement(){return this._element}open(){this._isOpen=!0,document.addEventListener("keydown",this._handleEscClose),this._element.classList.add("popup_opened")}querySelector(e){return this._element.querySelector(e)}checkIfOpened(){return this._isOpen}setEventListeners(){this._element.querySelector(".popup__close-button").addEventListener("click",this.close),this._element.addEventListener("mousedown",(e=>{e.target.classList.contains("popup_opened")&&this.close()}))}}class i extends n{constructor(e,t){super(e),this._submit=t,this._form=this._element.querySelector(".popup__form")}_getInputValues(){const e={},t=this._element.querySelectorAll(".popup__input");for(let s=0;s<t.length;s++)e[input.name]=input.value;return e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{this._submit(e)}))}}const r=new class{constructor(e){let{name:t,job:s,avatar:n}=e;this._about=document.querySelector(s),this._name=document.querySelector(t),this._avatar=document.querySelector(n)}getUserInfo(){return{name:this._name.textContent,job:this._about.textContent,avatar:this._avatar.src}}setUserInfo(e){this._about.textContent=e.about,this._name.textContent=e.name,e.avatar&&(this._avatar.src=e.avatar)}setUserUrl(e){this._avatar.src=e}}({name:".profile__name",job:".profile__about-me",avatar:".profile__avatar"}),o={},a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".profile__image-button"),u=new i(".popup_profile",(function(e){e.preventDefault();const t={name:S.value,about:L.value};r.setUserInfo(t),fetch("https://around.nomoreparties.co/v1/group-12/users/me",{method:"PATCH",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61","Content-Type":"application/json"},body:JSON.stringify({name:S.value,about:L.value})}),O()}));u.setEventListeners();const _=new class extends n{constructor(e,t){super(e),this._button=this._element.querySelector(t),this._isOpen=!1}}(".popup_confirm",".popup__button");_.setEventListeners();const h=new i(".popup_add",(function(e){e.preventDefault(),k.toggleButtonState(b.querySelector(".popup__button"),!1),w.addItem({name:C.value,link:q.value}),fetch("https://around.nomoreparties.co/v1/group-12/cards",{method:"POST",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61","Content-Type":"application/json"},body:JSON.stringify({name:C.value,link:q.value})}),x()}));h.setEventListeners();const d=new i(".popup_avatar",(function(e){e.preventDefault(),r.setUserUrl(E.value),fetch("https://around.nomoreparties.co/v1/group-12/users/me/avatar",{method:"PATCH",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61","Content-Type":"application/json"},body:JSON.stringify({avatar:E.value})}),j()}));d.setEventListeners();const p=new class extends n{constructor(e,t,s){var n,i;super(e),i=()=>{super.open(),this._image.setAttribute("src",this._url),this._image.setAttribute("alt",this._caption),this.getElement().querySelector(".popup__text").textContent=this._caption},(n="open")in this?Object.defineProperty(this,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):this.open=i,this._url=t,this._caption=s,this._image=this.getElement().querySelector(".popup__image")}setImage(e){let{caption:t,url:s}=e;this._url=s,this._caption=t}}(".popup_image");p.setEventListeners();const m=document.getElementById("editform"),b=document.getElementById("addform"),f=document.getElementById("avatarform"),v={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__error-massage_visible"},g=new t(v,f),k=new t(v,b),y=new t(v,m),E=document.getElementById("avatar"),S=document.getElementById("popupname"),L=document.getElementById("popupaboutme"),C=document.getElementById("title"),q=document.getElementById("imagelink"),I=[],w=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderer=n,this._items=s,this._element=document.querySelector(t)}addItem(e){const t=this._renderer(e);this._element.prepend(t)}render(){for(let e=0;e<this._items.length;e++)this.addItem(this._items[e])}}({items:I,renderer:function(t){return new e(t.name,t.link,t.id,t.likes,B,_,t.owner).generateCard()}},".cards");function B(e){let{url:t,caption:s}=e;p.setImage({url:t,caption:s}),p.open()}function O(){if(u.checkIfOpened())u.close();else{u.open();const{name:e,job:t}=r.getUserInfo();S.value=e,L.value=t}}function j(){d.checkIfOpened()?(d.close(),f.reset()):d.open()}function x(){h.checkIfOpened()?(h.close(),b.reset()):h.open()}g.enableValidation(),k.enableValidation(),y.enableValidation(),l.addEventListener("click",x),a.addEventListener("click",O),c.addEventListener("click",j),fetch("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61"}}).then((e=>e.json())).then((e=>{o.name=e.name,o.about=e.about,o.avatar=e.avatar,r.setUserInfo(o)})).catch((e=>{console.log(e)})),fetch("https://around.nomoreparties.co/v1/group-12/cards",{method:"GET",headers:{authorization:"614bb6fa-36a6-4d24-9b95-72bf17bccf61"}}).then((e=>e.json())).then((e=>{for(let t=0;t<e.length;t++){const s={name:e[e.length-1-t].name,link:e[e.length-1-t].link,id:e[e.length-1-t]._id,likes:e[e.length-1-t].likes,owner:e[e.length-1-t].owner};I[t]=s}console.log(e),w.render()})).catch((e=>{console.log(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UyxFQUFLRSxHQUFHbEQsS0FBTUMsS0FBTWtMLEVBQU1BLEVBQUtuSSxPQUFTLEVBQUtFLEdBQUdqRCxLQUFNQyxHQUFJaUwsRUFBTUEsRUFBS25JLE9BQVMsRUFBS0UsR0FBR2hDLElBQUtmLE1BQU9nTCxFQUFNQSxFQUFLbkksT0FBUyxFQUFLRSxHQUFHL0MsTUFBT0csTUFBTzZLLEVBQU1BLEVBQUtuSSxPQUFTLEVBQUtFLEdBQUc1QyxPQUNwTjhKLEVBQVVsSCxHQUFLNEgsRUFFbkJRLFFBQVFDLElBQUlKLEdBQ1psQyxFQUFhNEIsWUFFaEJPLE9BQU9DLElBQ0pDLFFBQVFDLElBQUlGLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBsaW5rLCBpZCwgbGlrZXMsIGhhbmRsZUltYWdlQ2xpY2ssIGNvbmZpcm1Qb3B1cCwgb3duZXIpIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgICAgICB0aGlzLl9pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybVBvcHVwID0gY29uZmlybVBvcHVwO1xyXG4gICAgICAgIHRoaXMuX293bmVyID0gb3duZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gKiAqIHRoaXMgZnVuY3Rpb24gZ2VuZXJhdGVzIHRoZSBjYXJkIFxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZUNhcmQoKTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUxpa2VzKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gKiAqIHRoaXMgZnVuY3Rpb24gc2V0cyBhbGwgdGhlIGluZm8gb2YgdGhlIGNhcmRcclxuICAgIF9jcmVhdGVDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9lbGVtZW50O1xyXG4gICAgICAgIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgICAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGV4dFwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgY2FyZEltYWdlLmFsdCA9IGBBIHZpZXcgb2YgJHsgdGhpcy5fbmFtZSB9YDtcclxuICAgICAgICBjYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1udW1iZXJcIikudGV4dENvbnRlbnQgPSB0aGlzLl9nZXRMaWtlTnVtYmVyKCk7XHJcbiAgICAgICAgcmV0dXJuIGNhcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3Jlc2V0Q2FyZExpa2VzKCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLW51bWJlclwiKS50ZXh0Q29udGVudCA9IHRoaXMuX2dldExpa2VOdW1iZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAqICogdGhpcyBmdW5jdGlvbiBjcmVhdGVzIHRoZSBjYXJkIHRlbXBsYXRlXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkdGVtcGxhdGVcIilcclxuICAgICAgICAgICAgLmNvbnRlbnRcclxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIGlmICh0aGlzLl9vd25lcikge1xyXG4gICAgICAgICAgICBpZiAoISh0aGlzLl9vd25lci5faWQgPT09ICdiOGJkMjE4MzVhNDVmZWEwYzM2ZGQ3NzYnKSkge1xyXG4gICAgICAgICAgICAgICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGVcIikuY2xhc3NMaXN0LmFkZChcImNhcmRfX2RlbGV0ZV9oaWRkZW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRMaWtlTnVtYmVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9saWtlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gKiAqIHRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhbGwgdGhlIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKS5jbGFzc0xpc3QuY29udGFpbnMoXCJpbmZvX19jYXJkX2xpa2UtYnV0dG9uX3N0YXRlX2FjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fanVzdExpa2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9jaGVja0xpa2VzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGVcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlybVBvcHVwLm9wZW4oKTtcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlybVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX293bmVyLl9pZCA9PT0gJ2I4YmQyMTgzNWE0NWZlYTBjMzZkZDc3NicpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmV0Y2goYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvJHt0aGlzLl9pZH1gLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI2MTRiYjZmYS0zNmE2LTRkMjQtOWI5NS03MmJmMTdiY2NmNjFcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbmZpcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyB1cmw6IHRoaXMuX2xpbmssIGNhcHRpb246IHRoaXMuX25hbWUgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2lzTGlrZWQoKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9saWtlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbGlrZXNbaV0uX2lkID09PSAnYjhiZDIxODM1YTQ1ZmVhMGMzNmRkNzc2Jykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyAqICogdGhpcyBmdW5jdGlvbiB0b2dnbGVzIGxpa2VzIGZvciB0aGUgY2FyZHNcclxuICAgIF9jaGVja0xpa2VzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9qdXN0TGlrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpLmNsYXNzTGlzdC5hZGQoXCJpbmZvX19jYXJkX2xpa2UtYnV0dG9uX3N0YXRlX2FjdGl2ZVwiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2xpa2VzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saWtlc1t0aGlzLl9saWtlcy5sZW5ndGhdID0gdGhpcy5fb3duZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmV0Y2goYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvbGlrZXMvJHt0aGlzLl9pZH1gLCB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI2MTRiYjZmYS0zNmE2LTRkMjQtOWI5NS03MmJmMTdiY2NmNjFcIixcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2p1c3RMaWtlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKS5jbGFzc0xpc3QucmVtb3ZlKFwiaW5mb19fY2FyZF9saWtlLWJ1dHRvbl9zdGF0ZV9hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpa2VzLnBvcCgpO1xyXG4gICAgICAgICAgICBmZXRjaChgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcy9saWtlcy8ke3RoaXMuX2lkfWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiBcIjYxNGJiNmZhLTM2YTYtNGQyNC05Yjk1LTcyYmYxN2JjY2Y2MVwiLFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkTGlrZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlTGlrZXMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xpa2VzKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fbGlrZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9saWtlc1tpXS5faWQgPT09ICdiOGJkMjE4MzVhNDVmZWEwYzM2ZGQ3NzYnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpLmNsYXNzTGlzdC5hZGQoXCJpbmZvX19jYXJkX2xpa2UtYnV0dG9uX3N0YXRlX2FjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyAqICogdGhpcyBmdW5jdGlvbiBkZWxldGVzIHRoZSBjYXJkXHJcbiAgICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfVxyXG59OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1Ub1ZhbGlkYXRlKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IGZvcm1Ub1ZhbGlkYXRlO1xyXG4gICAgICAgIHRoaXMuX3NldFNldHRpbmdzKHNldHRpbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0U2V0dGluZ3Moc2V0dGluZ3MpIHtcclxuICAgICAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBzZXR0aW5ncy5mb3JtU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5fZm9ybVNlbGVjdG9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XHJcbiAgICAgICAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUlucHV0RXZlbnQoZXZ0LnRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZUJ1dHRvbigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyAhIHRoaXMgZnVuY3Rpb24gaGFuZGxlcyB0aGUgZXJyb3IgbWFzc2FnZSBzdGF0ZSBhY2NvcmRpbmcgdG8gdGhlIGlucHV0IHZhbGlkaXR5XHJcbiAgICBfaGFuZGxlSW5wdXRFdmVudChpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBpbnB1dEVsZW1lbnQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSkge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGVycm9yTWVzc2FnZSwgdGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0Vycm9yTWVzc2FnZShlcnJvck1lc3NhZ2UsIHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyAhIHRoaXMgZnVuY3Rpb24gY2hlY2tlcyBpZiB0aGUgZm9ybSBpcyB2YWxpZFxyXG4gICAgX2NoZWNrRm9ybVZhbGlkaXR5KGZvcm1FbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IFsuLi5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgICAgICAgICAgbGV0IGlzVmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0TGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRMaXN0W2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaXNWYWxpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gISB0aGlzIGZ1bmN0aW9uIGhpZGVzIHRoZSBlcnJvciBtYXNzYWdlXHJcbiAgICBfaGlkZUVycm9yTWVzc2FnZShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAhIHRoaXMgZnVuY3Rpb24gc2hvd3MgdGhlIGVycm9yIG1hc3NhZ2VcclxuICAgIF9zaG93RXJyb3JNZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vICEgdGhpcyBmdW5jdGlvbiBoYW5kbGVzIHRoZSBidXR0b24gc3RhdGUgYWNjb3JkaW5nIHRvIHRoZSBmb3JtIHZhbGlkaXR5XHJcbiAgICB2YWxpZGF0ZUJ1dHRvbigpIHtcclxuICAgICAgICBjb25zdCBmb3JtQnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICBpZiAodGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkodGhpcy5fZm9ybSwgdGhpcy5faW5wdXRTZWxlY3RvcikpIHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZShmb3JtQnV0dG9uLCB0cnVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKGZvcm1CdXR0b24sIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gISB0aGlzIGZ1bmN0aW9uIGNoZWNrZXMgaWYgdGhlIGlucHV0IGlzIHZhbGlkXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gISB0aGlzIGZ1bmN0aW9uIHRvZ2dsZXMgYnV0dG9uIHN0YXRlXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZShidXR0b24sIGlzVmFsaWQpIHtcclxuICAgICAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICAgICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2lzT3BlbiA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEVsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faXNPcGVuID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBxdWVyeVNlbGVjdG9yKGNsYXNzTmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY2xhc3NOYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC5jb2RlID09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja0lmT3BlbmVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc09wZW47XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2UpO1xyXG5cclxuICAgICAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3RvcihjbGFzc1NlbGVjdG9yLCBzdWJtaXQpIHtcclxuICAgICAgICBzdXBlcihjbGFzc1NlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXQgPSBzdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKVxyXG4gICAgfVxyXG5cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICAgICAgY29uc3QgaW5wdXRzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdChldnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiIGltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuIGltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuIGltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbiBpbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuIGltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuIGltcG9ydCBQb3B1cENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtXCI7XHJcbiBpbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuIGltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcclxuXHJcbiAvLyAhIHVzZXJcclxuIGNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHsgbmFtZTogXCIucHJvZmlsZV9fbmFtZVwiLCBqb2I6IFwiLnByb2ZpbGVfX2Fib3V0LW1lXCIsIGF2YXRhcjogXCIucHJvZmlsZV9fYXZhdGFyXCIgfSk7XHJcbiBjb25zdCB1c2VyT2JqZWN0ID0ge307XHJcbiAvLyAhIGJ1dHRvbnNcclxuIGNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG4gY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG4gY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1idXR0b25cIik7XHJcbiAvLyAhIHBvcHVwXHJcbiBjb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9wcm9maWxlXCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuIHByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gY29uc3QgY29uZmlybVBvcHVwID0gbmV3IFBvcHVwQ29uZmlybShcIi5wb3B1cF9jb25maXJtXCIsIFwiLnBvcHVwX19idXR0b25cIik7XHJcbiBjb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4gY29uc3QgYWRkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hZGRcIiwgaGFuZGxlQWRkRm9ybVN1Ym1pdCk7XHJcbiBhZGRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF9hdmF0YXJcIiwgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcbiBhdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuIGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfaW1hZ2VcIik7XHJcbiBpbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAvLyAhIGZvcm1zXHJcbiBjb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXRmb3JtXCIpO1xyXG4gY29uc3QgYWRkRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZGZvcm1cIik7XHJcbiBjb25zdCBhdmF0YXJGb3JtRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFyZm9ybVwiKTtcclxuIGNvbnN0IHNldHRpbmdzID0ge1xyXG4gICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9pbnZhbGlkXCIsXHJcbiAgICAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3ItbWFzc2FnZV92aXNpYmxlXCJcclxuIH07XHJcbiBjb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm1FbGVtZW50KVxyXG4gY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhZGRGb3JtRWxlbWVudCk7XHJcbiBjb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBlZGl0Rm9ybUVsZW1lbnQpO1xyXG4gLy8gISBpbnB1dHNcclxuIGNvbnN0IGF2YXRhclVybElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXJcIik7XHJcbiBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvcHVwbmFtZVwiKTtcclxuIGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb3B1cGFib3V0bWVcIik7XHJcbiAvLyAhaW5wdXQgaGVscFxyXG4gY29uc3QgdGl0bGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGl0bGVcIik7XHJcbiBjb25zdCBpbWFnZUxpbmtJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2VsaW5rXCIpO1xyXG4gLy8gISBpbml0aWFsIGNhcmRzXHJcbiBjb25zdCBjYXJkc0RhdGEgPSBbXTtcclxuXHJcbiAvLyAgISBzZWN0aW9uXHJcbiBjb25zdCBjYXJkc1NlY3Rpb24gPSBuZXcgU2VjdGlvbih7IGl0ZW1zOiBjYXJkc0RhdGEsIHJlbmRlcmVyOiBjcmVhdGVDYXJkIH0sIFwiLmNhcmRzXCIpO1xyXG5cclxuIGZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZE9iaikge1xyXG4gICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChjYXJkT2JqLm5hbWUsIGNhcmRPYmoubGluaywgY2FyZE9iai5pZCwgY2FyZE9iai5saWtlcywgaGFuZGxlSW1hZ2VDbGljaywgY29uZmlybVBvcHVwLCBjYXJkT2JqLm93bmVyKTtcclxuICAgICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuIH1cclxuXHJcbiBmdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKHsgdXJsLCBjYXB0aW9uIH0pIHtcclxuICAgICBpbWFnZVBvcHVwLnNldEltYWdlKHsgdXJsLCBjYXB0aW9uIH0pO1xyXG4gICAgIGltYWdlUG9wdXAub3BlbigpO1xyXG4gfVxyXG5cclxuIGF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4gLy8gISBlZGl0IGZvcm0gaGFuZGxlXHJcbiBmdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcclxuICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgY29uc3QgdXNlck9iaiA9IHsgbmFtZTogbmFtZUlucHV0LnZhbHVlLCBhYm91dDogam9iSW5wdXQudmFsdWUgfTtcclxuICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyT2JqKTtcclxuXHJcbiAgICAgZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiNjE0YmI2ZmEtMzZhNi00ZDI0LTliOTUtNzJiZjE3YmNjZjYxXCIsXHJcbiAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICBuYW1lOiBuYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgICAgICAgICBhYm91dDogam9iSW5wdXQudmFsdWVcclxuICAgICAgICAgfSlcclxuICAgICB9KTtcclxuXHJcbiAgICAgdG9nZ2xlRWRpdFBvcHVwV2luZG93KCk7XHJcbiB9XHJcblxyXG4gLy8gISBhdmF0YXIgZm9ybSBoYW5kbGVcclxuIGZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgIHVzZXJJbmZvLnNldFVzZXJVcmwoYXZhdGFyVXJsSW5wdXQudmFsdWUpO1xyXG5cclxuICAgICBmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiNjE0YmI2ZmEtMzZhNi00ZDI0LTliOTUtNzJiZjE3YmNjZjYxXCIsXHJcbiAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICBhdmF0YXI6IGF2YXRhclVybElucHV0LnZhbHVlLFxyXG4gICAgICAgICB9KVxyXG4gICAgIH0pO1xyXG4gICAgIHRvZ2dsZUF2YXRhclBvcHVwV2luZG93KCk7XHJcbiB9XHJcblxyXG4gLy8gISBhZGQgZm9ybSBoYW5kbGVcclxuIGZ1bmN0aW9uIGhhbmRsZUFkZEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgIGFkZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoYWRkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uXCIpLCBmYWxzZSk7XHJcbiAgICAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0oeyBuYW1lOiB0aXRsZUlucHV0LnZhbHVlLCBsaW5rOiBpbWFnZUxpbmtJbnB1dC52YWx1ZSB9KTtcclxuXHJcbiAgICAgZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsIHtcclxuICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI2MTRiYjZmYS0zNmE2LTRkMjQtOWI5NS03MmJmMTdiY2NmNjFcIixcclxuICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgIH0sXHJcbiAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgIG5hbWU6IHRpdGxlSW5wdXQudmFsdWUsXHJcbiAgICAgICAgICAgICBsaW5rOiBpbWFnZUxpbmtJbnB1dC52YWx1ZVxyXG4gICAgICAgICB9KSxcclxuICAgICB9KTtcclxuXHJcbiAgICAgdG9nZ2xlQWRkUG9wdXBXaW5kb3coKTtcclxuIH1cclxuXHJcbiAvLyAqICogdGhpcyBmdW5jdGlvbiB0b2dnbGVzIHRoZSBwb3B1cCB3aW5kb3cgZm9yIHRoZSBlZGl0IHdpbmRvdyBcclxuIGZ1bmN0aW9uIHRvZ2dsZUVkaXRQb3B1cFdpbmRvdygpIHtcclxuICAgICBpZiAoIXByb2ZpbGVQb3B1cC5jaGVja0lmT3BlbmVkKCkpIHtcclxuICAgICAgICAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICAgICAgICAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKClcclxuICAgICAgICAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICAgICAgICAgam9iSW5wdXQudmFsdWUgPSBqb2I7XHJcbiAgICAgfSBlbHNlIHtcclxuICAgICAgICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgfVxyXG4gfVxyXG5cclxuIGZ1bmN0aW9uIHRvZ2dsZUF2YXRhclBvcHVwV2luZG93KCkge1xyXG4gICAgIGlmICghYXZhdGFyUG9wdXAuY2hlY2tJZk9wZW5lZCgpKSB7XHJcbiAgICAgICAgIGF2YXRhclBvcHVwLm9wZW4oKTtcclxuICAgICB9IGVsc2Uge1xyXG4gICAgICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICBhdmF0YXJGb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgIH1cclxuIH1cclxuXHJcbiAvLyAqICogdGhpcyBmdW5jdGlvbiB0b2dnbGVzIHRoZSBwb3B1cCB3aW5kb3cgZm9yIHRoZSBhZGQgd2luZG93IFxyXG4gZnVuY3Rpb24gdG9nZ2xlQWRkUG9wdXBXaW5kb3coKSB7XHJcbiAgICAgaWYgKCFhZGRQb3B1cC5jaGVja0lmT3BlbmVkKCkpIHtcclxuICAgICAgICAgYWRkUG9wdXAub3BlbigpO1xyXG4gICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGFkZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgIGFkZEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICAgfVxyXG4gfVxyXG5cclxuIC8vICEgY2FsbGluZyBldmVudCBsaXN0ZW5lcnNcclxuIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdG9nZ2xlQWRkUG9wdXBXaW5kb3cpO1xyXG5cclxuIGVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRvZ2dsZUVkaXRQb3B1cFdpbmRvdyk7XHJcblxyXG4gYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0b2dnbGVBdmF0YXJQb3B1cFdpbmRvdyk7XHJcblxyXG4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiBcIjYxNGJiNmZhLTM2YTYtNGQyNC05Yjk1LTcyYmYxN2JjY2Y2MVwiXHJcbiAgICAgICAgIH1cclxuICAgICB9KVxyXG4gICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXHJcbiAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgdXNlck9iamVjdC5uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgICAgICB1c2VyT2JqZWN0LmFib3V0ID0gZGF0YS5hYm91dDtcclxuICAgICAgICAgdXNlck9iamVjdC5hdmF0YXIgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlck9iamVjdCk7XHJcbiAgICAgfSlcclxuICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgIH0pO1xyXG5cclxuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkc1wiLCB7XHJcbiAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI2MTRiYjZmYS0zNmE2LTRkMjQtOWI5NS03MmJmMTdiY2NmNjFcIlxyXG4gICAgICAgICB9XHJcbiAgICAgfSlcclxuICAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxyXG4gICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgY29uc3QgY2FyZE9iaiA9IHsgbmFtZTogZGF0YVsoZGF0YS5sZW5ndGggLSAxKSAtIGldLm5hbWUsIGxpbms6IGRhdGFbKGRhdGEubGVuZ3RoIC0gMSkgLSBpXS5saW5rLCBpZDogZGF0YVsoZGF0YS5sZW5ndGggLSAxKSAtIGldLl9pZCwgbGlrZXM6IGRhdGFbKGRhdGEubGVuZ3RoIC0gMSkgLSBpXS5saWtlcywgb3duZXI6IGRhdGFbKGRhdGEubGVuZ3RoIC0gMSkgLSBpXS5vd25lciB9O1xyXG4gICAgICAgICAgICAgY2FyZHNEYXRhW2ldID0gY2FyZE9iajtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgY2FyZHNTZWN0aW9uLnJlbmRlcigpO1xyXG4gICAgIH0pXHJcbiAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICB9KTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWU6IG5hbWVTZWxlY3Rvciwgam9iOiBhYm91dFNlbGVjdG9yLCBhdmF0YXI6IGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBqb2I6IHRoaXMuX2Fib3V0LnRleHRDb250ZW50LCBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmMgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh1c2VySW5mbykge1xyXG4gICAgICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XHJcbiAgICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICAgICAgaWYgKHVzZXJJbmZvLmF2YXRhcikge1xyXG4gICAgICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyVXJsKGF2YXRhclVybCkge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXJVcmw7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGJ1dHRvblNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGJ1dHRvblNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9pc09wZW4gPSBmYWxzZTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB1cmwsIGNhcHRpb24pIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91cmwgPSB1cmw7XHJcbiAgICAgICAgdGhpcy5fY2FwdGlvbiA9IGNhcHRpb247XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLmdldEVsZW1lbnQoKS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbWFnZSh7IGNhcHRpb24sIHVybCB9KSB7XHJcbiAgICAgICAgdGhpcy5fdXJsID0gdXJsO1xyXG4gICAgICAgIHRoaXMuX2NhcHRpb24gPSBjYXB0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4gPSAoKSA9PiB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl91cmwpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLl9jYXB0aW9uKTtcclxuICAgICAgICB0aGlzLmdldEVsZW1lbnQoKS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX190ZXh0XCIpLnRleHRDb250ZW50ID0gdGhpcy5fY2FwdGlvbjtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5faXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5hZGRJdGVtKHRoaXMuX2l0ZW1zW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwibmFtZSIsImxpbmsiLCJpZCIsImxpa2VzIiwiaGFuZGxlSW1hZ2VDbGljayIsImNvbmZpcm1Qb3B1cCIsIm93bmVyIiwidGhpcyIsIl9lbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIl9qdXN0TGlrZWQiLCJfY2hlY2tMaWtlcyIsIl9jb25maXJtUG9wdXAiLCJvcGVuIiwiX293bmVyIiwiX2lkIiwiX2RlbGV0ZUNhcmQiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiY2xvc2UiLCJfaGFuZGxlSW1hZ2VDbGljayIsInVybCIsIl9saW5rIiwiY2FwdGlvbiIsIl9uYW1lIiwiX2xpa2VzIiwiZ2VuZXJhdGVDYXJkIiwiX2NyZWF0ZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlTGlrZXMiLCJfZ2V0VGVtcGxhdGUiLCJjYXJkIiwiY2FyZEltYWdlIiwidGV4dENvbnRlbnQiLCJzcmMiLCJhbHQiLCJfZ2V0TGlrZU51bWJlciIsIl9yZXNldENhcmRMaWtlcyIsImNhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiYWRkIiwibGVuZ3RoIiwiX2lzTGlrZWQiLCJpIiwicmVtb3ZlIiwicG9wIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybVRvVmFsaWRhdGUiLCJfZm9ybSIsIl9zZXRTZXR0aW5ncyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJldnQiLCJfaGFuZGxlSW5wdXRFdmVudCIsInRhcmdldCIsInZhbGlkYXRlQnV0dG9uIiwiZXJyb3JNZXNzYWdlIiwicGFyZW50RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfaGlkZUVycm9yTWVzc2FnZSIsIl9zaG93RXJyb3JNZXNzYWdlIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiZm9ybUVsZW1lbnQiLCJpbnB1dExpc3QiLCJpc1ZhbGlkIiwiZm9ybUJ1dHRvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwidmFsaWRpdHkiLCJ2YWxpZCIsImJ1dHRvbiIsImRpc2FibGVkIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX2lzT3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjb2RlIiwiZ2V0RWxlbWVudCIsImNsYXNzTmFtZSIsImNoZWNrSWZPcGVuZWQiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJjbGFzc1NlbGVjdG9yIiwic3VibWl0Iiwic3VwZXIiLCJfc3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0cyIsImlucHV0IiwidmFsdWUiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYiIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXIiLCJhdmF0YXJTZWxlY3RvciIsIl9hYm91dCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRVc2VyVXJsIiwiYXZhdGFyVXJsIiwidXNlck9iamVjdCIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJhdmF0YXJCdXR0b24iLCJwcm9maWxlUG9wdXAiLCJ1c2VyT2JqIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRvZ2dsZUVkaXRQb3B1cFdpbmRvdyIsImJ1dHRvblNlbGVjdG9yIiwiX2J1dHRvbiIsImFkZFBvcHVwIiwiYWRkRm9ybVZhbGlkYXRvciIsImFkZEZvcm1FbGVtZW50IiwiY2FyZHNTZWN0aW9uIiwiYWRkSXRlbSIsInRpdGxlSW5wdXQiLCJpbWFnZUxpbmtJbnB1dCIsInRvZ2dsZUFkZFBvcHVwV2luZG93IiwiYXZhdGFyUG9wdXAiLCJhdmF0YXJVcmxJbnB1dCIsInRvZ2dsZUF2YXRhclBvcHVwV2luZG93IiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsInNldEF0dHJpYnV0ZSIsIl91cmwiLCJfY2FwdGlvbiIsInNldEltYWdlIiwiZWRpdEZvcm1FbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhdmF0YXJGb3JtRWxlbWVudCIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImNhcmRzRGF0YSIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9pdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlciIsImNhcmRPYmoiLCJyZXNldCIsInRoZW4iLCJyZXMiLCJqc29uIiwiZGF0YSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=